library(ISLR)
fix(Default)
attach(Default)
# Logistic Reg
set.seed(1)
log.fit <- glm(default~income+balance, family = binomial)
?glm
?sample

estimate_pred <- function() {
  train <- sample(nrow(Default), 8000)
  log.fit <- glm(default~income+balance, data = Default, 
                 family = binomial, subset = train)
  
  log.prob <- predict(log.fit, Default[-train,], type = 'response')
  glm.pred <- rep("No", nrow(Default[-train,]))
  glm.pred[log.prob > 0.5] = "Yes"
  tail(glm.pred)
  return(mean(glm.pred!=Default[-train, "default"]))
}
estimate_pred()

estimate_pred_stu <- function() {
  train <- sample(nrow(Default), 8000)
  log.fit <- glm(default~income+balance+student, data = Default, 
                 family = binomial, subset = train)
  
  log.prob <- predict(log.fit, Default[-train,], type = 'response')
  glm.pred <- rep("No", nrow(Default[-train,]))
  glm.pred[log.prob > 0.5] = "Yes"
  tail(glm.pred)
  return(mean(glm.pred!=Default[-train, "default"]))
}
estimate_pred_stu()


set.seed(1)
log.fit$coefficients
summary(glm(default~income+balance, data = Default, 
            family = binomial, subset = train))
boot.fn <- function(data, index) { return(coef(glm(default~income+balance, data=data,
                                               family=binomial, subset=index)))}
library(boot)
?boot
boot(Default, boot.fn, 50)
